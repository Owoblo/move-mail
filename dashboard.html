<!doctype html>
<html lang="en" class="scroll-smooth">

<head>
    <meta charset="utf-8">
    <title>Dashboard - MoveMail Pro</title>
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <link href="./css/vendors/aos.css" rel="stylesheet">
    <link href="./style.css" rel="stylesheet">
    <link href="./style1.css" rel="stylesheet">
    <script src="https://www.gstatic.com/firebasejs/9.6.10/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.10/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.10/firebase-firestore-compat.js"></script>
    <script src="https://js.stripe.com/v3/"></script>
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js"></script>
    
</head>

<body class="font-inter antialiased bg-gray-50 text-gray-900 tracking-tight">
    <div class="flex flex-col min-h-screen overflow-hidden">
        <header class="absolute w-full z-30">
            <div class="max-w-6xl mx-auto px-4 sm:px-6">
                <div class="flex items-center justify-between h-16 md:h-20">
                    <div class="shrink-0 mr-4">
                        <a class="inline-flex" href="index.html" aria-label="Cruip">
                            <img src="./images/update.jpg" width="50" height="50" alt="Logo" />
                        </a>
                    </div>
                </div>
            </div>
        </header>

        <main class="relative grow flex">
            <div class="w-full">
                <div class="h-full flex flex-col justify-center before:min-h-[4rem] md:before:min-h-[5rem] before:flex-1 after:flex-1">
                    <div class="px-4 sm:px-6">
                        <div class="w-full max-w-sm mx-auto">
                            <div class="py-16 md:py-20">
                                <h1 class="text-4xl font-bold mb-6" id="welcomeMessage">Welcome to Your Dashboard!</h1>
                                <div id="creditsDisplay">You have <span id="credits">0</span> credits.</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <footer class="footer">
        <p>&copy; 2023 MovingLeads. All rights reserved.</p>
        <div class="mt-2">
            <a href="/terms" class="text-blue-600 hover:underline">Terms of Service</a>
            {" | "}
            <a href="/privacy" class="text-blue-600 hover:underline">Privacy Policy</a>
        </div>
    </footer>

    <script src="./js/vendors/alpinejs.min.js" defer></script>
    <script src="./js/vendors/aos.js"></script>
    <script src="./js/main.js" defer></script>
    <!-- Add Funds Button -->
    <button id="addFundsButton" class="btn mt-4 bg-blue-500 text-white">Add Funds</button>

    <!-- Payment Modal -->
    <div id="paymentModal" class="hidden">
        <div class="modal-content">
            <h2>Add Funds</h2>
            <div>
                <button class="btn" onclick="redirectToStripe(100)">Buy 180 Credits - $100</button>
                <button class="btn" onclick="redirectToStripe(200)">Buy 400 Credits - $200</button>
                <button class="btn" onclick="redirectToStripe(1000)">Buy 2200 Credits - $1000</button>
            </div>
            <div>
                <input type="number" id="customAmount" placeholder="Enter custom amount" />
                <button class="btn" onclick="calculateCredits()">Calculate Credits</button>
                <p id="customCredits"></p>
                <button class="btn" onclick="redirectToStripe(customAmount)">Buy Custom Credits</button>
            </div>
            <button class="btn" onclick="closeModal()">Close</button>
        </div>
    </div>

    <script>
        const user = firebase.auth().currentUser;

        if (user) {
            const userRef = firebase.firestore().collection("users").doc(user.uid);
            userRef.get().then((doc) => {
                if (doc.exists) {
                    const userData = doc.data();
                    document.getElementById('welcomeMessage').textContent = `Welcome ${userData.company || 'User'}!`;
                    document.getElementById('credits').textContent = userData.credits || 0;
                }
            }).catch((error) => {
                console.error("Error fetching user data:", error);
            });
        } else {
            // Redirect to sign-in if not authenticated
            window.location.href = 'signin.html';
        }
    </script>
</body>

</html> 